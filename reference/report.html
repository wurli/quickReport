<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create an Excel Report — report_from_sql • quickReport</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Create an Excel Report — report_from_sql" />
<meta property="og:description" content="These functions can be used to quickly generate a fairly decent Excel
workbook containing a collection of datasets. report_from_data() allows you
to export a list of data.frames (where worksheet names are taken from the
list names), while report_from_sql() will read the data using a directory
containing SQL scripts (where worksheet names are taken from the SQL script
names). A main advantage of these functions is the ability to supply an
existing Excel template - see 'Details' for more information." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">quickReport</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/options.html">Options</a>
    </li>
    <li>
      <a href="../articles/report_example.html">Report Example</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/wurli/quickReport/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create an Excel Report</h1>
    <small class="dont-index">Source: <a href='https://github.com/wurli/quickReport/blob/master/R/report_from_.R'><code>R/report_from_.R</code></a></small>
    <div class="hidden name"><code>report.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>These functions can be used to quickly generate a fairly decent Excel
workbook containing a collection of datasets. <code>report_from_data()</code> allows you
to export a list of data.frames (where worksheet names are taken from the
list names), while <code>report_from_sql()</code> will read the data using a directory
containing SQL scripts (where worksheet names are taken from the SQL script
names). A main advantage of these functions is the ability to supply an
existing Excel template - see 'Details' for more information.</p>
    </div>

    <pre class="usage"><span class='fu'>report_from_sql</span><span class='op'>(</span>
  filename <span class='op'>=</span> <span class='fu'><a href='nice_filename.html'>nice_filename</a></span><span class='op'>(</span>dir <span class='op'>=</span> <span class='st'>"Outputs"</span><span class='op'>)</span>,
  file_template <span class='op'>=</span> <span class='st'>"Excel/template.xlsx"</span>,
  coversheet_content <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>C5 <span class='op'>=</span> <span class='fu'><a href='info_table.html'>default_info_table</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>,
  sql_directory <span class='op'>=</span> <span class='st'>"SQL"</span>,
  sql_connection <span class='op'>=</span> <span class='fu'><a href='connect_to_database.html'>connect_to_database</a></span><span class='op'>(</span><span class='op'>)</span>,
  transformers <span class='op'>=</span> <span class='cn'>NULL</span>,
  save_on_complete <span class='op'>=</span> <span class='cn'>TRUE</span>,
  open_on_complete <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/interactive.html'>interactive</a></span><span class='op'>(</span><span class='op'>)</span>,
  creator <span class='op'>=</span> <span class='fu'><a href='get_user.html'>get_user</a></span><span class='op'>(</span><span class='op'>)</span>,
  cover_template <span class='op'>=</span> <span class='fl'>1</span>,
  data_template <span class='op'>=</span> <span class='fl'>2</span>
<span class='op'>)</span>

<span class='fu'>report_from_data</span><span class='op'>(</span>
  filename <span class='op'>=</span> <span class='fu'><a href='nice_filename.html'>nice_filename</a></span><span class='op'>(</span>dir <span class='op'>=</span> <span class='st'>"Outputs"</span><span class='op'>)</span>,
  file_template <span class='op'>=</span> <span class='st'>"Excel/template.xlsx"</span>,
  coversheet_content <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>C5 <span class='op'>=</span> <span class='fu'><a href='info_table.html'>default_info_table</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>,
  datasets <span class='op'>=</span> <span class='cn'>NULL</span>,
  transformers <span class='op'>=</span> <span class='cn'>NULL</span>,
  save_on_complete <span class='op'>=</span> <span class='cn'>TRUE</span>,
  open_on_complete <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/interactive.html'>interactive</a></span><span class='op'>(</span><span class='op'>)</span>,
  creator <span class='op'>=</span> <span class='fu'><a href='get_user.html'>get_user</a></span><span class='op'>(</span><span class='op'>)</span>,
  cover_template <span class='op'>=</span> <span class='fl'>1</span>,
  data_template <span class='op'>=</span> <span class='fl'>2</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>filename</th>
      <td><p>The name of the file to create</p></td>
    </tr>
    <tr>
      <th>file_template</th>
      <td><p>A filepath pointing to an Excel workbook to use as a
template. See 'Details' for more information.</p></td>
    </tr>
    <tr>
      <th>coversheet_content</th>
      <td><p>Content used to populate the report coversheet.
This should be a named list of data.frames where the names are Excel-style
cell references giving the upper-left corner of each data.frame.</p></td>
    </tr>
    <tr>
      <th>sql_directory</th>
      <td><p>A directory containing the SQL files to be used in the
report.</p></td>
    </tr>
    <tr>
      <th>sql_connection</th>
      <td><p>A connection to an SQL database. See <a href='https://db.rstudio.com/getting-started/connect-to-database/'>this article from RStudio</a> for a
good introduction to the topic.</p></td>
    </tr>
    <tr>
      <th>transformers</th>
      <td><p>Can be either a single function that will be applied to
each dataset or a named list of functions. If the latter:</p><ul>
<li><p>Names should correspond to the names of the sql to indicate the tables
the functions should be applied to</p></li>
<li><p>If you supply an unnamed function, this will be applied to each table
that doesn't have a corresponding named function. You can think of this as
a 'default' transformation.</p></li>
</ul></td>
    </tr>
    <tr>
      <th>save_on_complete</th>
      <td><p>Set <code>FALSE</code> to not save the workbook on completion.
This may be useful, e.g. if you want to apply further manipulations to the
report before saving.</p></td>
    </tr>
    <tr>
      <th>open_on_complete</th>
      <td><p>If <code>TRUE</code> then the file will be opened in Excel once
written.</p></td>
    </tr>
    <tr>
      <th>creator</th>
      <td><p>This name will be used to set the 'Creator' and 'Last Modified
By' fields in the workbook.</p></td>
    </tr>
    <tr>
      <th>cover_template, data_template</th>
      <td><p>The names/indices of the worksheets to
use as templates for the coversheet/data sheets. By default these will
respectively be the first and second sheets of the template workbook.</p></td>
    </tr>
    <tr>
      <th>datasets</th>
      <td><p>A named list containing data.frames. The names will be used
as worksheet names in the final report.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An <code>openxlsx</code> workbook object</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Reports generated with quickReport consist of a coversheet containing
report information and separate sheets for each dataset included. You can
provide a template for a report by supplying a path to an existing workbook
in the <code>template</code> field. By default, the first sheet will be used as a
template for the report coversheet, while the second will be used as a
template for each data sheet added to the report. If you wish to use a
different template for a dataset included in the report, you can do
this by including a worksheet in the template workbook with the same name as
the dataset in question. Within the template worksheets you can specify where
the data should be placed by entering the marker <code>'!data'</code> in the first cell
where the data should appear. You can change the marker value using
<code><a href='https://rdrr.io/r/base/options.html'>options(qr.marker = "new-value")</a></code>.</p>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jacob Scott.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


